"""
Pytest configuration for Django tests
Provides shared fixtures and test settings
"""
import os
import django
from pathlib import Path
from django.conf import settings

# Configure Django settings
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'kinderGartenAPI.settings')
django.setup()


def pytest_configure():
    """Configure pytest with Django test database"""
    if not settings.configured:
        settings.configure(
            DEBUG=True,
            DATABASES={
                'default': {
                    'ENGINE': 'django.db.backends.sqlite3',
                    'NAME': ':memory:',
                }
            },
            INSTALLED_APPS=[
                'django.contrib.auth',
                'django.contrib.contenttypes',
                'core',
                'children',
                'attendance',
                'reports',
                'planning',
                'chat',
                'accounts',
            ],
            MIDDLEWARE=[
                'django.middleware.security.SecurityMiddleware',
                'django.contrib.sessions.middleware.SessionMiddleware',
                'django.middleware.common.CommonMiddleware',
                'django.contrib.auth.middleware.AuthenticationMiddleware',
            ],
            REST_FRAMEWORK={
                'DEFAULT_PAGINATION_CLASS': 'rest_framework.pagination.PageNumberPagination',
                'PAGE_SIZE': 20,
            },
            SECRET_KEY='test-secret-key',
            USE_TZ=True,
        )
